#include <iostream>
using namespace std;
class Node 
{
public:
    string name;
    Node *next;
    Node(string n) 
	{  
        name = n;
        next = NULL;
    }
};
class Commetie 
{
public:
    Node *head;
    Node *winners;
    int totalAmount;
    int totalMembers;
    int winnersCount;
    Commetie(int amount, int members) 
	{
        head = NULL;
        winners = NULL;
        totalAmount = amount;
        totalMembers = members;
        winnersCount = 0;
    }
    addMember(string name) 
	{
        Node *newNode = new Node(name);
        if (head == NULL) 
		{
            head = newNode;
        } 
		else 
		{
            Node* temp = head;
            while (temp->next != NULL) 
			{
                temp = temp->next;
            }
            temp->next = newNode;
        }
    }
    int hasWon(string name) 
	{
        Node *temp = winners;
        while (temp != NULL) 
		{
            if (temp->name == name);
            temp = temp->next;
        }
    }
    drawWinner() 
	{
        if (winnersCount >= totalMembers) 
		{
            cout <<"\nAll members have won once! The committee cycle is completed!\n";
        }
        cout << "\nPress Enter to draw a winner...";
        cin.ignore();
        cin.get();
        Node *temp = head;
        Node *eligible = NULL;
        Node *eligibleTail = NULL;
        while (temp != NULL) 
		{
            if (!hasWon(temp->name)) 
			{
                Node *newNode = new Node(temp->name);
                if (eligible == NULL) 
				{
                    eligible = newNode;
                    eligibleTail = newNode;
                } 
				else 
				{
                    eligibleTail->next = newNode;
                    eligibleTail = newNode;
                }
            }
            temp = temp->next;
        }
        int count = 0;
        temp = eligible;
        while (temp != NULL) 
		{
            count++;
            temp = temp->next;
        }

			int index = 0;  
			if (count > 0) 
			{  
			    index = rand() % count;  
			}

        temp = eligible;
        for (int i = 0; i < index; i++) {
            temp = temp->next;
        }

        Node *newWinner = new Node(temp->name);
        newWinner->next = winners;
        winners = newWinner;
        winnersCount++;

        cout << "\n\t\t\t\t==============================================\n";
        cout << "\t\t\t\tCONGRATULATIONS!\n";
        cout << "\t\t\t\tWinner of this month's committee: " << temp->name << "\n";
        cout << "\t\t\t\tPrize Amount: Rs. " << totalAmount << "\n";
        cout << "\t\t\t\t==============================================\n";
    }
};
int main() 
{
    system("CLS");
    cout << "\t\t\t\t\t**********************************************\n";
    cout << "\t\t\t\t\t*     WELCOME TO COMMITTEE Management        *\n";
    cout << "\t\t\t\t\t*   By M.Faizan --> FA22-BSE-052 <--         *\n";
    cout << "\t\t\t\t\t**********************************************\n";
    cout << "\n\t\t\t\t\tPress any key to start...\n";
    cin.ignore();
    cin.get();
    system("CLS");
    char startNewCommittee;
    do 
	{
        int oneMemberContribution, n;
        cout << "----------------------------------------------\n";
        cout << "Enter the details for the new committee:\n";
        cout << "----------------------------------------------\n";
        cout << "Enter contribution per member (Rs.): ";
        cin >> oneMemberContribution;
        
        cout << "Enter total number of members: ";
        cin >> n;
        
        int totalAmount = oneMemberContribution * n;
        
        Commetie committee(totalAmount, n);

        cout << "\nNow, enter the names of the committee members:\n";
        for (int i = 0; i < n; i++) 
		{
            string name;
            cout << "   Enter name for member " << i + 1 << ": ";
            cin >> name;
            committee.addMember(name);
        }
        cout << "\nAll members added successfully!\n";
        cout << "----------------------------------------------\n";
        cout << "Now, let's start picking winners!\n";
        cout << "----------------------------------------------\n";
        for (int i = 0; i < n; i++) 
		{
            committee.drawWinner();
        }
        cout << "\nCommittee round completed successfully!\n";
        cout << "----------------------------------------------\n";
        cout << "\nDo you want to start a new committee? (y/n): ";
        cin >> startNewCommittee;

        if (startNewCommittee == 'y' || startNewCommittee == 'Y') 
		{
            system("CLS");
        }
    }while (startNewCommittee == 'y' || startNewCommittee == 'Y');
    cout << "\nThank you for using the Committee Management System!\n";
    cout << "==============================================\n";
}